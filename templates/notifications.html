{% extends "base.html" %}

{% block content %}
<div class="dashboard-header animate-slide-up">
    <div>
        <h1 class="gradient-text">Activity Log</h1>
        <p class="text-secondary">Full history of system notifications and automated events.</p>
    </div>
    <div class="header-actions">
        <div class="pulse-indicator">
            <span class="pulse-dot"></span>
            Real-time Audit
        </div>
    </div>
</div>

<div class="card animate-fade-in">
    <div class="table-container">
        <table>
            <thead>
                <tr>
                    <th style="width: 60px;">Type</th>
                    <th>Message</th>
                    <th>Metadata</th>
                    <th>Time</th>
                </tr>
            </thead>
            <tbody>
                {% for n in notifications %}
                <tr>
                    <td>
                        <div class="ni-icon n-type-{{ n.type }}"
                            style="width: 36px; height: 36px; border-radius: 10px;">
                            {% if n.type == 'payment' %}
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <rect x1="1" y1="4" width="22" height="16" rx="2" ry="2"></rect>
                                <line x1="1" y1="10" x2="23" y2="10"></line>
                            </svg>
                            {% elif n.type == 'order' %}
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
                                <line x1="3" y1="6" x2="21" y2="6"></line>
                            </svg>
                            {% elif n.type == 'member' %}
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                            {% else %}
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                                fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round"
                                stroke-linejoin="round">
                                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                            </svg>
                            {% endif %}
                        </div>
                    </td>
                    <td>
                        <div style="font-weight: 600; color: var(--text-primary); font-size: 0.95rem;">{{ n.message }}
                        </div>
                        <span class="text-xs text-muted uppercase tracking-widest">{{ n.type }}</span>
                    </td>
                    <td>
                        {% if n.metadata %}
                        <div class="metadata-badges">
                            {% for key, val in n.metadata.items() %}
                            <span class="badge-mini"><strong>{{ key }}:</strong> {{ val }}</span>
                            {% endfor %}
                        </div>
                        {% else %}
                        <span class="text-xs text-muted">No extras</span>
                        {% endif %}
                    </td>
                    <td class="text-xs text-muted font-mono">{{ n.ts | datetimeformat }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="4" style="text-align: center; padding: 4rem;">
                        <div class="text-muted italic">The notification log is currently empty.</div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<style>
    .metadata-badges {
        display: flex;
        flex-wrap: wrap;
        gap: 0.4rem;
    }

    .badge-mini {
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.05);
        padding: 0.2rem 0.5rem;
        border-radius: 4px;
        font-size: 0.7rem;
        color: var(--text-secondary);
    }

    .n-type-payment {
        background: rgba(59, 130, 246, 0.15);
        color: #3b82f6;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .n-type-order {
        background: rgba(16, 185, 129, 0.15);
        color: #10b981;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .n-type-member {
        background: rgba(139, 92, 246, 0.15);
        color: #8b5cf6;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .n-type-status {
        background: rgba(245, 158, 11, 0.15);
        color: #f59e0b;
        display: flex;
        align-items: center;
        justify-content: center;
    }
</style>
{% endblock %}